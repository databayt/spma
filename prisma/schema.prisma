generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum Gender {
  MALE
  FEMALE
}

enum Sector {
  GOVERNMENT
  PRIVATE
  NGO
  ACADEMIC
  FREELANCE
}

enum OnboardingStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
}

enum ApplicationStatus {
  PENDING
  APPROVED
  REJECTED
}

enum Role {
  ADMIN
  MEMBER
  USER
}

model Member {
  id                String            @id @default(cuid())
  role              Role              @default(USER)
  fullNameAr        String
  fullNameEn        String
  email             String            @unique
  phone             String
  city              String
  gender            Gender
  image             String?
  cover             String?
  jobTitle          String?
  organization      String?
  yearsExperience   Int               @default(0)
  sector            Sector            @default(PRIVATE)
  certifications    String[]          @default([])
  committees        String[]          @default([])
  linkedin          String?
  twitter           String?
  onboardingStatus  OnboardingStatus  @default(NOT_STARTED)
  onboardingStep    String            @default("welcome")
  applicationStatus ApplicationStatus @default(PENDING)
  reviewedBy        String?
  reviewedAt        DateTime?
  reviewNotes       String?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime          @updatedAt

  @@index([onboardingStatus])
  @@index([applicationStatus])
  @@index([email])
}

model Article {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  description String
  image       String
  body        String
  author      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([slug])
}

model Book {
  id              String         @id @default(cuid())
  title           String
  author          String
  genre           String
  rating          Float          @default(0)
  coverUrl        String
  coverColor      String         @default("#000000")
  description     String
  totalCopies     Int            @default(1)
  availableCopies Int            @default(1)
  videoUrl        String?
  summary         String
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  borrowRecords   BorrowRecord[]

  @@index([genre])
  @@index([createdAt])
}

model BorrowRecord {
  id         String    @id @default(cuid())
  userId     String
  bookId     String
  borrowDate DateTime  @default(now())
  dueDate    DateTime
  returnDate DateTime?
  status     String    @default("BORROWED")
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  book       Book      @relation(fields: [bookId], references: [id], onDelete: Cascade)

  @@index([bookId])
  @@index([userId])
  @@index([status])
}
